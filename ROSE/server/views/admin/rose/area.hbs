{{#extend "css"}}
{{/extend}}

{{> sidebar}}

<div id="page-wrapper" ng-app="area" ng-controller="ctrl">
	<div class="row">
		<div class="col-lg-12">
			<h2 align="center">Khu vực {{areaId}}</h2>
		</div>
	</div>
	</br></br>
	<div class="row">
		<div class="col-xs-12">
			<table width="100%" class="table table-striped table-bordered table-hover" id="areaTable">
				<thead>
					<th style="text-align:center;">Nhiệt độ không khí</th>
					<th style="text-align:center;">Độ ẩm không khí</th>
					<th style="text-align:center;">Ánh sáng</th>
					<th style="text-align:center;">Độ pH</th>
					<th style="text-align:center;">Độ ẩm trung bình</th>
				</thead>
				<tbody>
				</tbody>
			</table>
		</div>
	</div>
	</br>
	<div class="row">
		<div class="col-xs-6">
			<div align="center">
				<h3>Các cảm biến độ ẩm</h3>
			</div>
			<div class="panel panel-default">
				<table width="100%" class="table table-striped table-bordered table-hover" id="humTable">
					<thead>
						<th style="text-align:center;">Mã chậu</th>
						<th style="text-align:center;">Giá trị</th>
					</thead>
					<tbody>
						<tr>
							<td style="text-align:center;">AD45</td>
							<td style="text-align:center;">10</td>
						</tr>
						<tr style="color:white; background-color:#1E88E5">
							<td style="text-align:center;">AD46</td>
							<td style="text-align:center;">5</td>
						</tr>
						<tr>
							<td style="text-align:center;">AD47</td>
							<td style="text-align:center;">10</td>
						</tr>
						<tr>
							<td style="text-align:center;">AD48</td>
							<td style="text-align:center;">15</td>
						</tr>
						<tr style="color:white; background-color:#1E88E5">
							<td style="text-align:center;">AD49</td>
							<td style="text-align:center;">20</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<div class="col-xs-6">
			<div align="center">
				<h3>Camera khu vực</h3>
			</div>
			<div>
				<img id="camera" width="100%" height="auto">
			</div>
		</div>
	</div>
	</br></br></br></br>
</div>

{{> footer}}

{{#extend "js"}}
	<script>
		$('#camera').attr('src', '/images/camera.jpg');
		
		let areaApp = angular.module('area', []);
		areaApp.controller("ctrl", function($scope, $http) {		
			function getInfo() {
				$.ajax({
					type: "GET",
					url: "/admin/api/area/detail/{{areaId}}",
					success: function(data) {
						refreshTable(JSON.parse(decodeURI(data)));
					}
				})
			}
			
			function refreshTable(data) {
				// Show data on the table
				$('#areaTable > tbody').empty();
				let htmlContent = '<tr class="even">';
				$.each(data, function (key, val) {
					htmlContent += '<td style="text-align:center;">' + val + '</td>';
				});
				htmlContent += '</tr>';
				$('#areaTable > tbody:last-child').append(htmlContent);
			}
			
			$(document).ready(function() {
				getInfo();
				window.setInterval(getInfo, 1000);
			});
		});
		
		areaApp.config(function($interpolateProvider) {
			$interpolateProvider.startSymbol('{');
			$interpolateProvider.endSymbol('}');
		});
    </script>
{{/extend}}
